<div class="packages-page-container">
  <!-- Breadcrumb Navigation -->
  <app-breadcrumb></app-breadcrumb>
  
  <div class="container my-5">
    <!-- Page Header -->
    <div class="packages-header mb-5">
      <div class="row align-items-center">
        <div class="col-md-8">
          <h1 class="packages-title">
            <i class="bi bi-compass me-2"></i>
            Discover Amazing Destinations
          </h1>
          <p class="packages-subtitle">Explore our curated collection of premium travel packages</p>
        </div>
        <div class="col-md-4 text-md-end">
          <div class="packages-count">
            <span class="count-number">{{ filteredPackages.length }}</span>
            <span class="count-label">Packages Available</span>
          </div>
        </div>
      </div>
    </div>

    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2 class="mb-0 d-none">Tour Packages <span class="badge bg-primary">{{ filteredPackages.length }}</span></h2>

    <!-- View Toggle -->
    <div class="btn-group" role="group">
      <button type="button"
              class="btn btn-outline-primary"
              [class.active]="viewMode === 'grid'"
              (click)="setViewMode('grid')">
        <i class="bi bi-grid-3x3-gap"></i> Grid
      </button>
      <button type="button"
              class="btn btn-outline-primary"
              [class.active]="viewMode === 'list'"
              (click)="setViewMode('list')">
        <i class="bi bi-list-ul"></i> List
      </button>
    </div>
  </div>

  <div class="row">
    <!-- Filters Sidebar -->
    <div class="col-lg-3 mb-4">
      <app-offers-filter (filterChange)="onFilterChange($event)"></app-offers-filter>
    </div>

    <!-- Packages Display -->
    <div class="col-lg-9">
      <!-- Loading State -->
      <div *ngIf="loading" class="text-center py-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>

      <!-- Search Results Summary -->
      <div *ngIf="!loading && currentSearchQuery && filteredPackages.length > 0" class="search-results-summary mb-4">
        <div class="alert alert-info d-flex align-items-center">
          <i class="bi bi-search me-2"></i>
          <span>
            Found <strong>{{ filteredPackages.length }}</strong> package{{ filteredPackages.length !== 1 ? 's' : '' }} 
            for "<strong>{{ currentSearchQuery }}</strong>"
          </span>
          <button 
            class="btn btn-sm btn-outline-secondary ms-auto"
            (click)="clearSearch()"
            title="Clear search">
            <i class="bi bi-x"></i> Clear
          </button>
        </div>
      </div>

      <!-- No Results -->
      <div *ngIf="!loading && filteredPackages.length === 0" class="empty-packages-state">
        <div class="empty-icon">
          <i class="bi bi-search"></i>
        </div>
        <h3>No Packages Found</h3>
        <p *ngIf="currentSearchQuery">
          We couldn't find any packages matching "<strong>{{ currentSearchQuery }}</strong>". 
          Try a different search term or adjust your filters.
        </p>
        <p *ngIf="!currentSearchQuery">
          We couldn't find any packages matching your criteria. Try adjusting your filters.
        </p>
        <button class="btn btn-outline-primary" (click)="clearFilters()">
          <i class="bi bi-arrow-clockwise me-2"></i>Clear Filters
        </button>
      </div>

      <!-- Grid View -->
      <div class="row g-4" *ngIf="!loading && filteredPackages.length > 0 && viewMode === 'grid'">
        <div class="col-md-6 col-xl-4" *ngFor="let package of filteredPackages">
          <app-package-card [package]="package"></app-package-card>
        </div>
      </div>

      <!-- List View -->
      <div class="list-view" *ngIf="!loading && filteredPackages.length > 0 && viewMode === 'list'">
        <div class="package-list-item mb-3" *ngFor="let package of filteredPackages">
          <div class="card shadow-sm">
            <div class="row g-0">
              <div class="col-md-4">
                <img [src]="package.imageUrl" class="img-fluid h-100 object-fit-cover" [alt]="package.name">
              </div>
              <div class="col-md-8">
                <div class="card-body">
                  <div class="d-flex justify-content-between align-items-start mb-2">
                    <h5 class="card-title mb-0">{{ package.name }}</h5>
                    <span class="badge bg-{{ package.type === 'DOMESTIC' ? 'success' : 'info' }}">
                      {{ package.type }}
                    </span>
                  </div>
                  <p class="card-text text-muted">{{ package.description }}</p>
                  <div class="d-flex flex-wrap gap-2 mb-3">
                    <span class="badge bg-secondary">
                      <i class="bi bi-calendar"></i> {{ package.days }}D/{{ package.nights }}N
                    </span>
                    <span class="badge bg-info">{{ package.category }}</span>
                    <span class="text-warning">
                      <i class="bi bi-star-fill"></i> {{ package.rating }} ({{ package.totalReviews }})
                    </span>
                  </div>
                  <div class="d-flex justify-content-between align-items-center">
                    <div>
                      <small class="text-muted d-block">Starts from</small>
                      <h5 class="text-primary mb-0">{{ package.currency }} {{ package.basePrice | number }}</h5>
                    </div>
                    <a [routerLink]="['/packages', package.slug || package.id]" class="btn btn-primary">
                      View Details <i class="bi bi-arrow-right"></i>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
